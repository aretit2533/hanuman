.TH HTTP_ROUTE 3 "2025-12-19" "Equinox Framework 1.0" "Equinox Framework Manual"
.SH NAME
http_route \- HTTP route management and matching functions
.SH SYNOPSIS
.nf
.B #include <http_route.h>
.PP
.BI "HTTP_ROUTE* http_route_create(HTTP_METHOD " method ", const char *" path ,
.BI "                             http_route_handler_fn " handler ,
.BI "                             void *" user_data );
.BI "void http_route_destroy(HTTP_ROUTE *" route );
.BI "int http_route_matches(HTTP_ROUTE *" route ", HTTP_METHOD " method ,
.BI "                      const char *" path );
.BI "int http_route_extract_params(HTTP_ROUTE *" route ", const char *" path ,
.BI "                             HTTP_REQUEST *" request );
.fi
.SH DESCRIPTION
The HTTP route API provides functions for creating, managing, and matching HTTP routes with support for path parameters.
.PP
.BR http_route_create ()
creates a new route that matches the specified HTTP
.I method
and URL
.IR path .
The
.I handler
function will be called when a matching request is received. Optional
.I user_data
can be passed to the handler.
.PP
The
.I path
can include parameters using colon syntax:
.RS
.TP
.B "/api/users/:id"
Matches /api/users/123, extracts id=123
.TP
.B "/api/posts/:postId/comments/:commentId"
Matches /api/posts/100/comments/5, extracts postId=100 and commentId=5
.RE
.PP
.BR http_route_destroy ()
destroys a route instance and frees its resources.
.PP
.BR http_route_matches ()
checks if a route matches the given HTTP
.I method
and URL
.IR path .
Returns 1 if the route matches, 0 otherwise. This function performs pattern matching with support for path parameters.
.PP
.BR http_route_extract_params ()
extracts path parameter values from a URL that matches the route pattern. The extracted parameters are added to the
.I request
object and can be retrieved using
.BR http_request_get_path_param (3).
.SH RETURN VALUE
.BR http_route_create ()
returns a pointer to HTTP_ROUTE on success, or NULL on failure.
.PP
.BR http_route_matches ()
returns 1 if the route matches the given method and path, 0 otherwise.
.PP
.BR http_route_extract_params ()
returns FRAMEWORK_SUCCESS (0) on success, or a negative error code on failure.
.SH ROUTE MATCHING ALGORITHM
Routes are matched using the following algorithm:
.IP 1. 3
Exact path matching is attempted first for efficiency
.IP 2. 3
If no exact match, pattern matching is performed:
.RS
.IP \(bu 2
Path and pattern are split into segments by '/'
.IP \(bu 2
Each segment is compared
.IP \(bu 2
Segments starting with ':' match any value (path parameter)
.IP \(bu 2
Literal segments must match exactly
.IP \(bu 2
Both paths must have the same number of segments
.RE
.SH EXAMPLE
.nf
#include <http_route.h>
#include <http_server.h>

void user_handler(HTTP_REQUEST *req, HTTP_RESPONSE *res, 
                 void *data) {
    const char *id = http_request_get_path_param(req, "id");
    
    char body[256];
    snprintf(body, sizeof(body), "User ID: %s", 
             id ? id : "unknown");
    http_response_set_text(res, body);
}

int main(void) {
    /* Create route with path parameter */
    HTTP_ROUTE *route = http_route_create(HTTP_METHOD_GET,
                                          "/api/users/:id",
                                          user_handler,
                                          NULL);
    
    /* Test matching */
    if (http_route_matches(route, HTTP_METHOD_GET, 
                          "/api/users/123")) {
        printf("Route matches!\\n");
    }
    
    http_route_destroy(route);
    return 0;
}
.fi
.SH NOTES
Path parameters are extracted automatically when a route matches. The parameter names are taken from the route pattern (without the ':' prefix).
.PP
Multiple path parameters can be used in a single route. Each parameter will be independently extracted and stored.
.PP
Route matching is case-sensitive for both the path and parameter values.
.SH SEE ALSO
.BR http_server (3),
.BR http_request_get_path_param (3),
.BR framework (3)
.SH AUTHOR
Equinox Framework Development Team
